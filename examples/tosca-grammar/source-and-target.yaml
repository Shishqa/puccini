tosca_definitions_version: tosca_simple_yaml_1_1

node_types:

  Application:
    derived_from: WebServer
    properties:
      url:
        type: string

topology_template:

  node_templates:

    server:
      type: Compute
      attributes:
        public_address: myapp.com
      requirements:
      - local_storage:
          node: storage
          relationship:
            properties:
              # Within relationships you can use "SOURCE" and "TARGET" keywords
              # For both the "get_property" and "get_attribute" functions
              location: { concat: [ /mnt/, { get_property: [ TARGET, volume_id ] } ] }
              device: /dev/hda1

    app:
      type: Application
      properties:
        # Another special kind of target is "HOST"
        # It refers to the target of any "HostedOn" relationship we have
        url: { get_attribute: [ HOST, public_address ] }
      requirements:
      - host:
          relationship: HostedOn

    storage:
      type: BlockStorage
      properties:
        volume_id: bucket
        size: 20 gib
